{"ast":null,"code":"import _classCallCheck from \"/Users/ellekennedyvalentine/Dev/mod5 /week_1/react-project-DBO/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/ellekennedyvalentine/Dev/mod5 /week_1/react-project-DBO/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/ellekennedyvalentine/Dev/mod5 /week_1/react-project-DBO/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/ellekennedyvalentine/Dev/mod5 /week_1/react-project-DBO/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/ellekennedyvalentine/Dev/mod5 /week_1/react-project-DBO/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/ellekennedyvalentine/Dev/mod5 /week_1/react-project-DBO/client/src/App.js\";\n//------------------------------------------------------------------------------------------------------------------\n// IMPORTS\n//------------------------------------------------------------------------------------------------------------------\nimport React, { Component } from 'react';\nimport { Route, Switch, withRouter } from 'react-router-dom';\nimport HomePage from './pages/HomePage';\nimport Header from './pages/Header';\nimport SignInForm from './pages/SignInForm';\nimport Inventory from './pages/Inventory';\nimport SignUpForm from './pages/SignUpForm'; //grab the validate function from the api.js to use \n\nimport { validate } from './services/api';\nimport { getTransactions } from './services/api';\nimport { getUsers } from './services/api';\nimport { getAllStocks } from './services/api'; //graphs \n\nimport { allTransactionsCategory } from '../src/services/GraphApis';\nimport './App.css'; //------------------------------------------------------------------------------------------------------------------\n// APP CLASS \n//------------------------------------------------------------------------------------------------------------------\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, App);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(App)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      // this is the initial state and when someone signsin this will be updated by the setState below\n      username: '',\n      user: {},\n      transactions: [],\n      savingPots: [],\n      allstocks: [],\n      test: [],\n      sum: [],\n      total_category: [] //------------------------------------------------------------------------------------------------------------------\n      // sign in\n      //------------------------------------------------------------------------------------------------------------------\n      // only one user can be signed in at once so when they are the username will be replaced eachtime\n      //update sign in since it was expecting a string now it will be getting a little object with username and id\n\n    };\n\n    _this.signin = function (user) {\n      getAllStocks().then(function (data) {\n        _this.setState({\n          allstocks: data,\n          user: user,\n          transactions: user.transactions,\n          savingPots: user.saving_pots,\n          username: user.username\n        }, function () {\n          _this.props.history.push('/inventory');\n        });\n      }); // this.setState({transactions: user.transactions})\n      // this.setState({savingPots: user.saving_pots})\n      // this.setState({allstocks: user.allstocks})\n      // this.setState({ username: user.username })\n\n      localStorage.setItem('token', user.token); // add token\n    };\n\n    _this.signout = function () {\n      _this.setState({\n        username: ''\n      });\n\n      _this.props.history.push('/');\n\n      localStorage.removeItem('token');\n    };\n\n    _this.setTransactionsTotalCategory = function () {\n      allTransactionsCategory(_this.props.user.id).then(function (data) {\n        _this.setState({\n          total_category: data\n        });\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    //------------------------------------------------------------------------------------------------------------------\n    // component did mount - validate user token\n    //------------------------------------------------------------------------------------------------------------------\n    //import validate function at top\n    //check if we have a token - then -> if we dont show error - but if there is no error then we get our user - hench we can assume the id we had stored in local storage was valid\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      if (localStorage.token) {\n        validate().then(function (data) {\n          // if (data.error){\n          //   alert(data.error)\n          // } else\n          // {\n          _this2.signin(data); // }\n\n        });\n      }\n    } //total categories\n\n  }, {\n    key: \"render\",\n    //------------------------------------------------------------------------------------------------------------------\n    // render component\n    //------------------------------------------------------------------------------------------------------------------\n    value: function render() {\n      var signin = this.signin,\n          signout = this.signout;\n      var _this$state = this.state,\n          username = _this$state.username,\n          transactions = _this$state.transactions,\n          savingPots = _this$state.savingPots,\n          allstocks = _this$state.allstocks,\n          user = _this$state.user; // so we can pass the username down to the header to welcome the user\n\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, React.createElement(Header, {\n        username: username,\n        signout: signout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }), React.createElement(Switch, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }, React.createElement(Route, {\n        exact: true,\n        path: \"/\",\n        component: function component(props) {\n          return React.createElement(HomePage, Object.assign({\n            user: user,\n            allstocks: allstocks,\n            savingPots: savingPots,\n            transactions: transactions,\n            username: username\n          }, props, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 133\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }), \" />\", React.createElement(Route, {\n        path: \"/signin\",\n        component: function component(props) {\n          return React.createElement(SignInForm, Object.assign({\n            signin: signin\n          }, props, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 134\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/inventory\",\n        component: function component(props) {\n          return React.createElement(Inventory, Object.assign({\n            user: user,\n            allstocks: allstocks,\n            savingPots: savingPots,\n            transactions: transactions,\n            username: username\n          }, props, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 135\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/signup\",\n        component: function component(props) {\n          return React.createElement(SignUpForm, Object.assign({\n            signin: signin\n          }, props, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 136\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }), React.createElement(Route, {\n        component: function component() {\n          return React.createElement(\"h1\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 137\n            },\n            __self: this\n          }, \"Page not found.\");\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      })));\n    } //------------------------------------------------------------------------------------------------------------------\n\n  }]);\n\n  return App;\n}(Component); //------------------------------------------------------------------------------------------------------------------\n// EXPORT\n//------------------------------------------------------------------------------------------------------------------\n\n\nexport default withRouter(App); //  by adding withRouter in the import and at the export of App => we get match, location and history","map":{"version":3,"sources":["/Users/ellekennedyvalentine/Dev/mod5 /week_1/react-project-DBO/client/src/App.js"],"names":["React","Component","Route","Switch","withRouter","HomePage","Header","SignInForm","Inventory","SignUpForm","validate","getTransactions","getUsers","getAllStocks","allTransactionsCategory","App","state","username","user","transactions","savingPots","allstocks","test","sum","total_category","signin","then","data","setState","saving_pots","props","history","push","localStorage","setItem","token","signout","removeItem","setTransactionsTotalCategory","id"],"mappings":"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","sourcesContent":["//------------------------------------------------------------------------------------------------------------------\n// IMPORTS\n//------------------------------------------------------------------------------------------------------------------\n\nimport React, { Component } from 'react'\nimport { Route, Switch, withRouter} from 'react-router-dom'\n\nimport HomePage from './pages/HomePage'\nimport Header from './pages/Header'\nimport SignInForm from './pages/SignInForm'\nimport Inventory from './pages/Inventory'\nimport SignUpForm from './pages/SignUpForm'\n\n\n//grab the validate function from the api.js to use \nimport {validate} from './services/api'\nimport {getTransactions} from './services/api'\nimport {getUsers} from './services/api'\nimport {getAllStocks} from './services/api'\n\n\n//graphs \n\nimport {allTransactionsCategory} from '../src/services/GraphApis'\n\n\n\n\n\n\n\nimport './App.css'\n\n//------------------------------------------------------------------------------------------------------------------\n// APP CLASS \n//------------------------------------------------------------------------------------------------------------------\n\nclass App extends Component {\n\n// initial state\n//------------------------------------------------------------------------------------------------------------------\n  state = { // this is the initial state and when someone signsin this will be updated by the setState below\n    username:'',\n    user:{},\n    transactions:[],\n    savingPots:[],\n    allstocks:[],\n    test: [],\n    sum: [],\n    total_category: []\n  }\n//------------------------------------------------------------------------------------------------------------------\n// sign in\n//------------------------------------------------------------------------------------------------------------------\n  // only one user can be signed in at once so when they are the username will be replaced eachtime\n  //update sign in since it was expecting a string now it will be getting a little object with username and id\n  signin = (user) => { \n    \n    getAllStocks().then( data => \n      {\n        this.setState({allstocks: data, user: user, transactions: user.transactions, savingPots: user.saving_pots, username: user.username}, () => {\n          this.props.history.push('/inventory')\n        })\n      }\n    )\n    // this.setState({transactions: user.transactions})\n    // this.setState({savingPots: user.saving_pots})\n    // this.setState({allstocks: user.allstocks})\n    // this.setState({ username: user.username })\n\n    localStorage.setItem('token', user.token) // add token\n    \n\n  }\n//------------------------------------------------------------------------------------------------------------------\n\n// sign out\n//------------------------------------------------------------------------------------------------------------------\n// if we are signin we will also be want to be able to signout - here will again set the state of username back to nothing\n// now in signout it will also remove the token from local storage, we only need to give the key and dont require a value when we are using removeItem()\n// you could have also used  localStorage.clear('token') => but this would have removed everything and if we were also storing other stuff this would be a problem\nsignout = () => { \n   this.setState({username:''})\n   this.props.history.push('/')\n   localStorage.removeItem('token')\n }\n//------------------------------------------------------------------------------------------------------------------\n\n// component did mount - validate user token\n//------------------------------------------------------------------------------------------------------------------\n //import validate function at top\n //check if we have a token - then -> if we dont show error - but if there is no error then we get our user - hench we can assume the id we had stored in local storage was valid\n componentDidMount(){\n   if (localStorage.token){\n     validate()\n      .then(\n        data => {\n        // if (data.error){\n        //   alert(data.error)\n        // } else\n        // {\n          this.signin(data)\n        // }\n      }\n      )\n   }\n }\n\n\n //total categories\n\n setTransactionsTotalCategory = () => {\n      \n  allTransactionsCategory(this.props.user.id)\n    .then( data => {\n        this.setState({total_category: data})\n      } )\n\n     \n    }\n //------------------------------------------------------------------------------------------------------------------\n\n// render component\n//------------------------------------------------------------------------------------------------------------------\n  render() {\n    const {signin, signout} = this\n    const {username, transactions, savingPots, allstocks, user} = this.state // so we can pass the username down to the header to welcome the user\n\n    return (\n      <div className=\"App\">\n        <Header username={username} signout={signout}/> \n        <Switch> \n          <Route exact path='/' component={props => <HomePage user={user} allstocks={allstocks} savingPots={savingPots} transactions={transactions} username={username} {...props}/> } /> />\n          <Route path='/signin' component={props => <SignInForm signin={signin} {...props}/>} />\n          <Route path='/inventory' component={props => <Inventory user={user} allstocks={allstocks} savingPots={savingPots} transactions={transactions} username={username} {...props}/> } />\n          <Route path='/signup' component={props => <SignUpForm signin={signin} {...props}/>} />\n          <Route component={() => <h1>Page not found.</h1>} />\n        </Switch>\n      </div>\n    )\n  }\n//------------------------------------------------------------------------------------------------------------------\n\n}\n\n\n//------------------------------------------------------------------------------------------------------------------\n// EXPORT\n//------------------------------------------------------------------------------------------------------------------\n\n\nexport default withRouter(App)\n\n\n//  by adding withRouter in the import and at the export of App => we get match, location and history"]},"metadata":{},"sourceType":"module"}